"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const plugin_error_1 = __importDefault(require("plugin-error"));
const map_stream_1 = __importDefault(require("map-stream"));
const transformPackage_1 = require("./transformPackage");
function generateTypings(file, cb) {
    if (!file || file.isNull() || !file.contents) {
        return cb(new plugin_error_1.default("pluggable-widgets-typing-generator", "Empty XML, please check your src folder for file package.xml"));
    }
    if (file.isStream()) {
        return cb(new plugin_error_1.default("pluggable-widgets-typing-generator", "Streaming not supported"));
    }
    transformPackage_1.transformPackage(file.contents.toString("utf8"), file.base).then(() => cb(null), err => cb(new plugin_error_1.default("pluggable-widgets-typing-generator", err)));
}
module.exports = () => map_stream_1.default(generateTypings);
